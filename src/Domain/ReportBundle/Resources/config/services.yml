services:
    # managers
    domain_report.manager.subscription_report_manager:
        class: Domain\ReportBundle\Manager\SubscriptionReportManager
        arguments:
            - '@mongodb.manager'
        calls:
            - [ setContainer, [ '@service_container' ] ]
    domain_report.manager.category_report_manager:
        class: Domain\ReportBundle\Manager\CategoryReportManager
        arguments: [ '@mongodb.manager' ]
        calls:
            - [ setContainer, [ '@service_container' ] ]
    domain_report.manager.business_overview_report_manager:
        class: Domain\ReportBundle\Manager\BusinessOverviewReportManager
        arguments:
            - '@domain_business.manager.business_profile'
            - '@mongodb.manager'
        calls:
            - [ setContainer, [ '@service_container' ] ]

    domain_report.manager.keywords_report_manager:
        class: Domain\ReportBundle\Manager\KeywordsReportManager
        arguments: [ '@mongodb.manager' ]

    # export services
    domain_report.exporter:
        class: Domain\ReportBundle\Service\Export\Exporter
        calls:
            - [ setContainer, [ '@service_container' ]]
    domain_report.exporter.subscription_pdf_exporter:
        class: Domain\ReportBundle\Service\Export\SubscriptionPdfExporter
        calls:
            - [ setTemplateEngine, [ '@templating' ]]
            - [ setPdfGenerator, [ '@spraed.pdf.generator' ]]
            - [ setSubscriptionReportManager, [ '@domain_report.manager.subscription_report_manager' ]]
    domain_report.exporter.subscription_excel_exporter:
        class: Domain\ReportBundle\Service\Export\SubscriptionExcelExporter
        calls:
            - [ setPhpExcel, [ '@phpexcel' ]]
            - [ setSubscriptionReportManager, [ '@domain_report.manager.subscription_report_manager' ]]
            - [ setTranslator, [ '@translator.default' ]]
    domain_report.exporter.category_pdf_exporter:
        class: Domain\ReportBundle\Service\Export\CategoryPdfExporter
        calls:
            - [ setTemplateEngine, [ '@templating' ]]
            - [ setPdfGenerator, [ '@spraed.pdf.generator' ]]
            - [ setCategoryReportManager, [ '@domain_report.manager.category_report_manager' ]]
    domain_report.exporter.category_excel_exporter:
        class: Domain\ReportBundle\Service\Export\CategoryExcelExporter
        calls:
            - [ setPhpExcel, [ '@phpexcel' ]]
            - [ setCategoryReportManager, [ '@domain_report.manager.category_report_manager' ]]
            - [ setTranslator, [ '@translator.default' ]]
    domain_report.exporter.business_overview_pdf_exporter:
        class: Domain\ReportBundle\Service\Export\BusinessOverviewPdfExporter
        calls:
            - [ setTemplateEngine, [ '@templating' ]]
            - [ setPdfGenerator, [ '@spraed.pdf.generator' ]]
            - [ setViewsAndVisitorsReportManager, [ '@domain_report.manager.views_and_visitors' ]]
    domain_report.exporter.business_overview_excel_exporter:
        class: Domain\ReportBundle\Service\Export\BusinessOverviewExcelExporter
        calls:
            - [ setPhpExcel, [ '@phpexcel' ]]
            - [ setViewsAndVisitorsReportManager, [ '@domain_report.manager.views_and_visitors' ]]
            - [ setTranslator, [ '@translator.default' ]]

    domain_report.google_analytics.data_fetcher:
        class: Domain\ReportBundle\Google\Analytics\DataFetcher
        parent: happyr.google_analytics.data_fetcher
        calls:
            - [ setClientProvider, [ '@domain_report.google_analytics.client_provider' ]]

    domain_report.google_analytics.client_provider:
        class: Domain\ReportBundle\Google\Analytics\ClientProvider
        arguments: ['analytics@infopaginas-142911.iam.gserviceaccount.com', %kernel.root_dir%/config/key.p12]

    domain_report.manager.ad_usage:
        class: Domain\ReportBundle\Manager\AdUsageReportManager
        arguments: ['@doctrine.orm.entity_manager', '@oxa_dfp.manager', '@cache.provider.my_file_system']
    domain_report.manager.views_and_visitors:
        class: Domain\ReportBundle\Manager\ViewsAndVisitorsReportManager
        arguments: [ '@domain_report.manager.business_overview_report_manager' ]

    domain_report.exporter.excel:
        class: Domain\ReportBundle\Service\Export\BusinessReportExcelExporter
        calls:
            - [ setPhpExcel, [ '@phpexcel' ]]
            - [ setBusinessOverviewReportManager, [ '@domain_report.manager.business_overview_report_manager' ]]
            - [ setKeywordsReportManager, [ '@domain_report.manager.keywords_report_manager' ]]
            - [ setAdUsageReportManager, [ '@domain_report.manager.ad_usage' ]]
            - [ setTranslator, [ '@translator.default' ]]

    domain_report.exporter.pdf:
        class: Domain\ReportBundle\Service\Export\BusinessReportPdfExporter
        calls:
            - [ setBusinessOverviewReportManager, [ '@domain_report.manager.business_overview_report_manager' ]]
            - [ setKeywordsReportManager, [ '@domain_report.manager.keywords_report_manager' ]]
            - [ setAdUsageReportManager, [ '@domain_report.manager.ad_usage' ]]
            - [ setTemplateEngine, [ '@templating' ]]
            - [ setPdfGenerator, [ '@spraed.pdf.generator' ]]

    domain_report.manager.business_report_api_manager:
            class: Domain\ReportBundle\Manager\BusinessReportApiManager
            arguments: [ '@service_container' ]
