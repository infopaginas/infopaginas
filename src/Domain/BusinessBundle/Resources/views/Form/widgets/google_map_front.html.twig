<style>
    #google-map{
        background-color: #00A6C7;
        width: 366px;
        height: 305px;
    }
</style>

<div class="map-wrap">
    <div id="google-map"></div>
</div>

<script>
    //var addressInput = document.getElementById('{{ id }}');

    /**
     * Get address by coordinates
     */
    function geocodePlace(latlng, infowindow){
        var geocoder = new google.maps.Geocoder();

        geocoder.geocode({'location': latlng}, function(results, status) {
            if (results.length == 0) {
                return;
            }
            var place = results.shift();
            infowindow.setContent(place.formatted_address);
            //updateFieldValue(place.formatted_address);
            return results.shift();
        });
    }

    /**
     * Create marker
     */
    function addMarker(latlng,map,infowindow,formattedAddress) {
        var marker = new google.maps.Marker({
            position: latlng,
            map: map,
            draggable: true,
            title: formattedAddress
        });

        if(formattedAddress.length > 0){
            infowindow.open(map, marker);
        }
        infowindow.setContent(formattedAddress);

        // change address value when marker is dragged
        marker.addListener('dragend',function(event) {
            var latlng = {
                lat: event.latLng.lat(),
                lng: event.latLng.lng()
            };

            geocodePlace(latlng, infowindow);
            //updateFieldValue(event.latLng.lat(), event.latLng.lng())
        });

        // show and hide mark description
        marker.addListener('click',function(event) {
            infowindow.open(map, marker);
        });

        return marker;
    }

    /**
     * Update input value with new address
     */
    function updateFieldValue(formattedAddress) {
        addressInput.value = formattedAddress;
    }

    /**
     * Init map with search box
     */
    function initAutocomplete() {

        var infowindow = new google.maps.InfoWindow;

        var map = new google.maps.Map(document.getElementById('google-map'), {
            center: {lat: {{ latitude }}, lng: {{ longitude }} },
            zoom: {{ zoom }},
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });

        //var marker = addMarker(myLatLng, map, infowindow, '{{ value }}');

        var geocoder = new google.maps.Geocoder();
        geocoder.geocode({
            "address": "Minsk"
        }, function(results) {
            console.log(results[0].geometry.location.lat());
            console.log(results[0].geometry.location.lat());
        });
    }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key={{ google_api_key }}&libraries=places&callback=initAutocomplete&language={{ language }}"
        async defer
></script>