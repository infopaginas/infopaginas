<script>
  (function() {
    var useSSL = 'https:' == document.location.protocol;
    var src = (useSSL ? 'https:' : 'http:') +
        '//www.googletagservices.com/tag/js/gpt.js';
    document.write('<scr' + 'ipt src="' + src + '"></scr' + 'ipt>');
  })();
</script>

<script>
    /* see https://support.google.com/adwords/answer/1722096?hl=en */
    var BANNER_BREAK_POINT_728x90 = 740;
    var BANNER_BREAK_POINT_468x60 = 480;
    var BANNER_BREAK_POINT_320x50 = 320;

    var BASE_BREAK_POINT = 805;
    var RESPONSIVE_ADS_BLOCK_SIZE = 0.6;

    var BANNER_SIZE_728x90 = [728, 90];
    var BANNER_SIZE_468x60 = [468, 60];
    var BANNER_SIZE_320x50 = [320, 50];

    var googleResponsiveCommonSize = googletag.sizeMapping().
        addSize([0, 0], []).
        addSize([BANNER_BREAK_POINT_320x50, 0], BANNER_SIZE_320x50). // Mobile
        addSize([BANNER_BREAK_POINT_468x60, 0], BANNER_SIZE_468x60). // Tablet
        addSize([BANNER_BREAK_POINT_728x90, 0], BANNER_SIZE_728x90). // Desktop
        build();

    var googleResponsiveBlockSize;
    var windowWidth = window.innerWidth;

    var resizableWidth;

    if (windowWidth >= BASE_BREAK_POINT) {
        resizableWidth = windowWidth * RESPONSIVE_ADS_BLOCK_SIZE;
    } else {
        resizableWidth = windowWidth;
    }

    if (resizableWidth >= BANNER_BREAK_POINT_728x90) {
        googleResponsiveBlockSize = googletag.sizeMapping().addSize([0, 0], BANNER_SIZE_728x90).build();
    } else if (resizableWidth >= BANNER_BREAK_POINT_468x60) {
        googleResponsiveBlockSize = googletag.sizeMapping().addSize([0, 0], BANNER_SIZE_468x60).build();
    } else if (resizableWidth >= BANNER_BREAK_POINT_320x50) {
        googleResponsiveBlockSize = googletag.sizeMapping().addSize([0, 0], BANNER_SIZE_320x50).build();
    }

    googletag.cmd.push(function() {
        {% for item in bannerHeaders %}
            {% if item.code == BANNER_CODE.SEARCH_FLOAT_BOTTOM %}
                if (windowWidth < BASE_BREAK_POINT) {
                    {{ item.data | raw }}
                }
            {% else %}
                {{ item.data | raw }}
            {% endif %}
        {% endfor %}

        {% if dcDataDTO is defined and dcDataDTO is not null %}
            {% if dcDataDTO.searchKeywords is not empty %}
                googletag.pubads().setTargeting( "search", {{ dcDataDTO.searchKeywords|json_encode|raw }} );
            {% endif %}

            {% if dcDataDTO.locationName is not empty %}
                googletag.pubads().setTargeting( "location", "{{ dcDataDTO.locationName }}" );
            {% endif %}

            {% if dcDataDTO.categories is not empty %}
                googletag.pubads().setTargeting( "categories", {{ dcDataDTO.categories|json_encode|raw }} );
            {% endif %}

            {% if dcDataDTO.slug is not empty %}
                googletag.pubads().setTargeting( "slug", "{{ dcDataDTO.slug }}" );
            {% endif %}
        {% endif %}

        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
  });

    window.addEventListener( 'resize', function() {
        googletag.pubads().refresh();
    });
</script>
